.. -*-restructuredtext-*-

===========
remotenames
===========

------------
Introduction
------------

Keep track of remote names (branches and bookmarks) in Mercurial.

With this extension installed, Mercurial's behavior regarding bookmarks is
changed. The core of this extension is to keep track of remote bookmarks and
branches and to make a better user experience.

For example, when you pull from a repository listed in .hg/hgrc's ``[paths]``
section, you get output similar to the following::

 o  f3d8 @
 |  more trunk
 |
 o  824e
 |  trunk
 |
 | o  2b7b feature
 | |  feature: more new stuff
 | |
 | o  a342
 |/   feature: new stuff
 |
 o    52a8 (smf/default) [smf/@]
 |\   merge stable into default
 | |
 | o  9c95
 | |  chug along trunk
 | |
 o |  ea15 stable (smf/stable)
 | |  fix for stable

What this output is showing is that the head of the default branch in a repo at
path ``smf`` is ``52a8``. This is labeled above as ``smf/default``. Similarly,
the bookmark ``@`` was last seen on ``smf`` at the ``52a8`` changeset. Both
remote names cannot move unless you push or pull from the remote server.

For the above example, the name ``smf`` is used instead of ``default`` because
the .hg/hgrc is as follows::

  [paths]
  default = http://smf.io/hgremotenames
  smf = http://smf.io/hgremotenames

Since those two paths are equal, the non-default name is chosen.

Remote names are discovered by sending a single extra request to the Mercurial
server after the pull is complete. This extension works properly with paths
from the schemes extension included with Mercurial. Other extensions which
perform varying kinds of manipulation on the repository path may not function
as expected.

This extension is built on top of the Mercurial namespace API introduce in 3.3.

----------------
Behavior Changes
----------------

Since this extensions keeps track of the remote bookmarks, we no longer pull
them by default (similar with clone). Therefore, pulling from a remote server
will no longer pollute your bookmarks.

Expect changes.

The commands ``bookmarks``, ``branches``, and ``log`` all gain a ``--remote``
flag to display remote names. This will also unhide obsolete changesets.

---------
Templates
---------

Remotenames adds three template keywords: ``remotebranches``,
``remotebookmarks``, and ``remotenames`` which is the combination of the first
two. For example, the diagram above uses the template ``({remotebranches})
[{remotebookmarks}]``. You could drop the ``remotebranches`` keyword if that's
your fancy.

Alternatively, you could use ``remotenames`` to include both namespaces. If you
set the configurable option ``suppressbranches``::

  [remotenames]
  suppressbranches = True

Then ``remotenames`` will only display the branch name if there is no bookmark
present.

-----
Alias
-----

Experimental. Setting ``alias.default = True`` will drop the turn
``smf/default`` into just ``smf``.

-------
Revsets
-------

Remotenames makes three new revsets available: ``pushed()``, ``upstream()``,
``remotebranches()``, ``remotebookmarks()`` and ``remotenames()``. The
``pushed()`` revset returns all revisions that are have been pushed to any
repository tracked by remotenames. The ``upstream()`` set is those revisions
which are in a repository whose path is listed in the ``upstream`` field of the
``[remotenames]`` configuration section. If there is no
``remotenames.upstream`` setting, it defaults to behaving identically to
``pushed()``. The ``remotenames()`` revset simply returns all remote branches
head changesets.
