include_defs('//eden/DEFS')

# We test only with the oss version because it builds faster
# and we do not expect that testing against the internal version
# will provide any additional signal.
oss_suffix = get_oss_suffix()
daemon_target = '@/eden/fs/service:edenfs%s' % oss_suffix

python_unittest(
  name = 'hg',
  srcs = glob(['*.py']),
  env = {
    'EDENFS_SUFFIX': oss_suffix,
    'EDENFS_CLI_PATH': '$(location @/eden/fs/cli:cli)',
    'EDENFS_SERVER_PATH': '$(location %s)' % daemon_target,
    'EDENFS_POST_CLONE_PATH': '$(location @/eden/hooks/hg:post-clone)',
  },
  deps = [
    daemon_target,
    '@/eden/fs/cli:cli',
    '@/eden/fs/integration/hg/lib:testutil',
  ],
)
